target_default: 20_prep_data

packages:
  - EGRET
  - dplyr
  - lubridate

include: 15_summary_figs.yml

sources:
  - 20_prep_data/code/data_prep_fxns.R
  - 10_get_data/code/precip_fxns.R
  
targets:
  20_prep_data:
    depends:
      - discharge_eList
      - tp_dv_eList
      - ortho_p_filt_eList
      - p_combo_eList
      - ss_dv_eList
      - 20_prep_data/out/yearly_precip.csv
      - 20_prep_data/out/monthly_precip.csv

  discharge_eList:
    command: as.egret(INFO = discharge_info, Daily = discharge)
  
  # using all obs tp concentrations 
  tp_eList:
    command: mergeReport(INFO = tp_info, Daily = discharge, Sample = tp)
    
  # using various subsets/summaries of observed concentrations
  tp_first_eList:
    command: mergeReport(INFO = tp_info, Daily = discharge, Sample = tp_first)
    
  tp_last_eList:
    command: mergeReport(INFO = tp_info, Daily = discharge, Sample = tp_last)
    
  tp_mean_eList:
    command: mergeReport(INFO = tp_info, Daily = discharge, Sample = tp_mean)
    
  tp_first_eList:
    command: mergeReport(INFO = tp_info, Daily = discharge, Sample = tp_last)
    
  # using daily values output by gclas
  tp_dv_eList:
    command: mergeReport(INFO = tp_info, Daily = discharge, Sample = tp_daily)
    
  # using fn daily values output by gclas
  tp_dv_fn_eList:
    command: mergeReport(INFO = tp_info, Daily = discharge, Sample = tp_daily_fn)
      
  ortho_p_filt_eList:
    command: mergeReport(INFO = ortho_p_filt_info, Daily = discharge, Sample = ortho_p_filt)
  
  p_combo:
    command: combine_p_dat(diss_p, ortho_p_filt, ortho_p_unfilt)
    
  p_combo_eList:
    command: mergeReport(INFO = ortho_p_filt_info, Daily = discharge, Sample = p_combo)
    
  ss_eList:
    command: mergeReport(INFO = ss_info, Daily = discharge, Sample = ss)
    
  ss_dv_eList:
    command: mergeReport(INFO = ss_info, Daily = discharge, Sample = ss_daily)
    
  yearly_precip:
    command: summarize_yearly(precip_dat = msn_precip)
    
  20_prep_data/out/yearly_precip.csv:
    command: write.csv(yearly_precip, target_name, row.names = FALSE)
    
  monthly_precip:
    command: summarize_monthly(precip_dat = msn_precip)
    
  20_prep_data/out/monthly_precip.csv:
    command: write.csv(monthly_precip, target_name, row.names = FALSE)